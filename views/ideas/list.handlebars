<div class="listIdeas">
    <header class="listHeader">
        <a href="/ideas/create"><button>Criar Ideia</button></a>
        <a href="/logout"><button>Logout</button></a>
    </header>
    <ul class="ideasGrid">
    {{#each ideas}}
        <li class="ideaCard" data-id="{{this._id}}">
        <h3>{{this.title}}</h3>
        <h5 class="voteCount">{{this.likes.length}} voto(s)</h5>
        <p>Por: {{this.createdBy}}</p>
        <hr />
        <p class="description">{{this.description}}</p>
        <div class="info">
            <div class="info-left">
                <button class="like">Votar</button>
                {{#if this.isOwner}}
                    <a href="/ideas/{{this._id}}/delete" class="delete-link">
                        <img src="images/lixeira.svg" alt="lixeira">
                    </a>
                    <a href="/ideas/{{this._id}}/edit">
                        <img src="images/brush.svg" alt="brush">
                    </a>
                {{/if}}
            </div>
            <div class="category">
                {{this.category}}
            </div>
        </div>
        </li>
    {{/each}}
    </ul>
    <script>
        document.querySelectorAll(".delete-link").forEach(link => {
            link.addEventListener("click", async (e) => {
            e.preventDefault();
            if (!confirm("Tem certeza que deseja excluir esta ideia?")) return;

            const res = await fetch(link.href, { method: "POST" });
            if (res.ok) {
                location.reload();
            } else {
                alert("Erro ao excluir ideia.");
            }
            });
        });
    </script>
</div>
